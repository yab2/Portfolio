(function(){"use strict";const u={host:"https://assets.mailerlite.com",stylesheet:"https://assets.mailerlite.com/css/universal.css",facade:"ml"};class _{constructor(){this.eventCallbackMap={},window.addEventListener("message",e=>{if(this.isEventInvalid(e))return;const t=this.getEventAction(e);t&&this.eventCallbackMap[t]&&this.eventCallbackMap[t].forEach(s=>s(e))})}on(e,t){this.eventCallbackMap[e]||(this.eventCallbackMap[e]=[]),this.eventCallbackMap[e].push(t)}isEventInvalid(e){return!e||!e.data||typeof e.data!="string"}getEventAction(e){const t=e.data.split("-");if(t&&t.length>1&&t[0]==="mlWebformSubmitSuccess")return`submit-${t[1]}`;if(t&&t.length>1&&t[0]==="mlWebformRedirect"){let s=t[t.length-1],i=t.slice(1,t.length-1).join("-");["_blank","_self","_parent","_top"].indexOf(s)<0&&(i=t.slice(1).join("-"),s="_blank");const o=new URL(decodeURIComponent(i));return o&&o.protocol!=="javascript:"&&window.open(decodeURIComponent(i),s),null}return!t||t.length<8||t[0]!=="ml"?null:t[7]}}class p{constructor(e){this.config=e,this.bustCache=!1}noCache(){return this.bustCache=!0,this}make(e,t,s={}){this.bustCache&&(s.cache=Date.now().toString().concat(Math.round(Math.random()*1e15).toString()));const i=this._buildUrl(e,t,s),o=document.createElement("script");o.setAttribute("src",i),o.setAttribute("async",!0),document.head.appendChild(o)}_buildUrl(e,t=null,s={}){const i=this.config.host,o=this.config.facade;let n=e.includes("?")?"&":"";t!==null&&t!==""&&(s.callback=`${o}.fn.${t}`);for(const r in s){let a=s[r];typeof a=="string"&&a.replace("+","%2B"),typeof a=="boolean"&&(a=a?1:0),n+=`&${r}=${a}`}return n=n.slice(1),`${i}${e}${n&&!n.startsWith("&")?"?":""}${n}`}}class c{static set(e,t,s){let i="";if(s){const o=new Date;o.setTime(o.getTime()+s*24*60*60*1e3),i=`; expires=${o.toGMTString()}`}return document.cookie=`${e}=${t}${i}; path=/`,t}static get(e,t=null){const s=`${e}=`,i=document.cookie.split(";");for(let o=0;o<i.length;o++){let n=i[o];if(n=n.replace(/^\s+/,""),n.indexOf(s)==0)return n.substring(s.length,n.length)}return t}}const f="mailerlite_session_id",S="mailerlite:session_id";class m{constructor(){this.id=this.getVisitorId(7)}getVisitorId(e){return c.get(f)??c.get(S)??c.set(f,`${Date.now()}/${Math.floor(Math.random()*1e4)}`,e)}}class v{constructor(e,t){this.pageId=e,this.jsonpRequest=t}trackPageView(e){this.jsonpRequest.noCache().make(`/jsonp/${e}/pages/${this.pageId}/perz`,null,{session_id:new m().id})}}class C{constructor(e,t){this.postId=e,this.jsonpRequest=t}trackPageView(e){this.jsonpRequest.noCache().make(`/jsonp/${e}/posts/${this.postId}/perz`,null,{session_id:new m().id})}}class x{constructor(e,t){this.categoryId=e,this.jsonpRequest=t}trackPageView(e){this.jsonpRequest.noCache().make(`/jsonp/${e}/categories/${this.categoryId}/perz`,null,{session_id:new m().id})}}class d{static addEvent(e,t,s){e.addEventListener?e.addEventListener(t,s,!1):e.attachEvent&&e.attachEvent(`on${t}`,s)}static isMouseout(e){const t=e.relatedTarget||e.toElement,s=!t||t.nodeName=="HTML",i=e.clientY<10;return s&&i}static isMobile(){let e=!1;const t=navigator.userAgent||navigator.vendor||window.opera;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e}static isMobileOrTablet(){let e=!1;const t=navigator.userAgent||navigator.vendor||window.opera;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e}static isTablet(){return this.isMobileOrTablet()&&!this.isMobile()}static isDesktop(){return!this.isMobileOrTablet()}}class h{run(e,t,s,i,o,n,r=500){e.style.display="block",e.style[t]=s+(n||""),this.element=e,this.callback=o,this.runtime=r,this.styleAttribute=t,this.startStamp=new Date().getTime(),this.startValue=s,this.endValue=i,this.appendString=n,this.step()}step(){const e=new Date().getTime()-this.startStamp;if(e<this.runtime){let t=this.startValue+(this.endValue-this.startValue)*this.easeInOut(e/this.runtime);t=Math.round(t*100)/100,this.element.style[this.styleAttribute]=t+(this.appendString||""),requestAnimationFrame(this.step.bind(this))}else this.element.style[this.styleAttribute]=this.endValue,this.callback&&this.callback()}easeIn(e){return e*e}flip(e){return 1-e}easeOut(e){const t=this.flip(e);return this.flip(t*t)}easeInOut(e){return this.easeIn(e)+(this.easeOut(e)-this.easeIn(e))*e}}class E{constructor(e){this.config=e,this.initDiff=0}percent(){const e=this.getWindowHeight(),t=this.getDocHeight()-e;return this.initDiff=e/t*100,this.calculate()}calculate(){const e=this.getWindowHeight(),t=this.getDocHeight()-e,i=(this.getScrollPosition()+e)/t*100-this.initDiff;return Math.floor(i)}getScrollPosition(){return window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}getWindowHeight(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0}getDocHeight(){return Math.max(document.body.scrollHeight||0,document.documentElement.scrollHeight||0,document.body.offsetHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0,document.documentElement.clientHeight||0)}}class g{constructor(e,t,s,i){this.id=e.id,this.parentSlug=e.parent_slug,this.parentId=e.parent_id,this.groot_v2_id=e.groot_v2_id,this.url=e.url,this.slug=e.slug,this.settings=e.settings,this.template=e.template,this.jsonpRequest=t,this.account=s,this.shown=!1,this.added=!1,this.shouldTrackView=!1,this.grootEventListener=i}add(){throw new Error("You have to implement the method add()")}trackFormView(){this.account&&this.jsonpRequest.noCache().make(`/jsonp/${this.account}/forms/${this.id}/takel`)}getCookieNameWhenShown(){return`mailerlite_forms_shown_${this.parentId||this.id}`}getOldCookieNameWhenShown(){return`mailerlite:forms:shown:${this.parentId||this.id}`}getCookieNameWhenSubmitted(){return`mailerlite_forms_submitted_${this.parentId||this.id}`}getOldCookieNameWhenSubmitted(){return`mailerlite:forms:submitted:${this.parentId||this.id}`}getShownCookieValue(e){return e.get(this.getCookieNameWhenShown())||e.get(this.getOldCookieNameWhenShown())}getSubmittedCookieValue(e){return e.get(this.getCookieNameWhenSubmitted())||e.get(this.getOldCookieNameWhenSubmitted())}}class b extends g{add(){var t;this.added=!0,this.usesNebula()||(this.backdrop=this.injectBackdrop());let e=!0;return((t=this.settings)==null?void 0:t.form_type)==="fullscreen"&&!this.usesNebula()&&(e=!1),this.form=this.injectForm(e),this.listenForHideEvent(),this.listenForSizeEvent(),this.usesNebula()&&this.listenForInsetEvent(),this.listenForSubmitEvent(),this.added}setTriggers(){var t,s;const e=((t=this.settings)==null?void 0:t.triggers)??[];e.length||this.show();for(const i of e)switch(i){case"close":this.close();break;case"timeout":setTimeout(()=>this.show(),((s=this.settings)==null?void 0:s.timeout_seconds)*1e3);break;case"scroll":this.scroll();break}}close(){d.addEvent(window,"mouseout",e=>{e=e||window.event,d.isMouseout(e)&&this.show()})}scroll(){var t;const e=((t=this.settings)==null?void 0:t.scroll_percentage)??!1;return e&&d.addEvent(window,"scroll",()=>{new E().percent()>=e&&this.show()}),e}listenForHideEvent(){this.grootEventListener.on("hide",t=>{this.isEventForThisBuilder(t)&&this.hide()})}listenForSizeEvent(){const e=this.grootEventListener,t=this;e.on("setSize",s=>{if(t.isEventForThisBuilder(s)&&(t.iframeLoaded||t.settings.teaser_active_on_start)){const i=s.data.split("-"),o=parseInt(i[i.length-2]),n=parseInt(i[i.length-1]);!isNaN(o)&&!isNaN(n)&&(this.formHeight=i[i.length-2],this.formWidth=i[i.length-1],this.usesNebula()&&(this.form.style.height=i[i.length-2],this.form.style.width=i[i.length-1]))}})}listenForSubmitEvent(){var t,s;const e=this.grootEventListener;(t=this.settings)!=null&&t.groot_id&&e.on(`submit-${(s=this.settings)==null?void 0:s.groot_id}`,()=>{c.set(this.getCookieNameWhenSubmitted(),this.account,9999)}),this.usesNebula()&&e.on(`submit-${this.groot_v2_id}`,()=>{c.set(this.getCookieNameWhenSubmitted(),this.account,9999)})}listenForInsetEvent(){const e=this.grootEventListener,t=this;e.on("setInset",s=>{if(!t.isEventForThisBuilder(s))return;const i=s.data.split("-"),o=["0","auto","center"],n=[];n[0]=i[i.length-4],n[1]=i[i.length-3],n[2]=i[i.length-2],n[3]=i[i.length-1];let r=!1;for(let a=0;a<4;a++)o.includes(n[a])||(n[a]=n[a].replace("m","-"),isNaN(parseInt(n[a]))&&(r=!0));if(r){t.form.style.inset="auto 0 0 auto";return}n[0]==="center"&&(n[0]=`calc(50% - ${t.form.clientHeight/2}px)`),n[1]==="center"&&(n[1]=`calc(50% - ${t.form.clientWidth/2}px)`),n[2]==="center"&&(n[2]=`calc(50% - ${t.form.clientHeight/2}px)`),n[3]==="center"&&(n[3]=`calc(50% - ${t.form.clientWidth/2}px)`),t.form.style.inset=n.join(" ")})}injectBackdrop(){const e=document.createElement("div"),t={backgroundColor:"#00000080",position:"fixed",top:"0",bottom:"0",left:"0",right:"0",display:"none","z-index":1e4};for(const s in t)e.style[s]=t[s];return document.body.appendChild(e),e}injectForm(e){const t={position:"fixed",top:"0",bottom:"0",left:"0",right:"0",width:"100%",height:"100%",display:"none","z-index":10001},s=this.createIframe(t);if(e){document.body.appendChild(s);const i=this;i.iframeLoaded=!1,s.onload=function(){i.iframeLoaded=!0}}return s}createIframe(e={}){const t=document.createElement("iframe");let s=this.url;this.usesNebula()&&(s.includes("?")?s=`${s}&windowWidth=${document.body.clientWidth}`:s=`${s}?windowWidth=${document.body.clientWidth}`),t.setAttribute("src",s);for(const i in e)t.style[i]=e[i];return t.setAttribute("frameBorder","0"),t.setAttribute("allow","clipboard-write"),t}show(e=!1){var s;if(this.shown&&!e||!e&&!this.isShowAllowed())return!1;this.shown=!0,this.added||this.add();const t=(s=this.settings)==null?void 0:s.form_type;if(this.isTeaserActiveOnStart())this.showCallback();else if(t==="popup"||t==="halfscreen"||this.usesNebula()&&t==="fullscreen")this.showFadeForm();else if(t==="bar")this.showBarForm();else if(t==="slidebox")this.showSlideboxForm();else if(t==="fullscreen"){this.form.style.position="relative",this.form.style.height=`${window.innerHeight}px`,document.body.insertBefore(this.form,document.body.firstChild),this.form.style.display="block",this.form.style.marginTop=`-${this.form.style.height}`,this.form.style.opacity="1";const i=this;i.iframeLoaded=!1,this.form.onload=function(){i.iframeLoaded=!0},this.showFullscreenForm()}else this.backdrop&&(this.backdrop.style.display="block"),this.showCallback();return!0}showFadeForm(){if(!this.iframeLoaded){setTimeout(this.showFadeForm.bind(this),100);return}this.backdrop&&(this.backdrop.style.display="block"),new h().run(this.form,"opacity",0,1,this.showCallback.bind(this))}showBarForm(){var e;if(this.formHeight===void 0||!this.iframeLoaded){this.iframeLoaded&&(this.form.style.height="100%",this.form.style.inset="auto",this.form.style.left="0px",this.form.style.right="0px",this.form.style[(e=this.settings)==null?void 0:e.form_position]=`${-document.body.clientHeight}px`,this.form.style.display="block"),setTimeout(this.showBarForm.bind(this),100);return}this.settings.form_position==="top"&&this.settings.position_remain&&(this.form.style.position="absolute"),this.showFormWithSlideAnimation("height",this.formHeight)}showSlideboxForm(){var e;if(this.formWidth===void 0||!this.iframeLoaded){this.iframeLoaded&&(this.form.style.width="100%",this.form.style.maxHeight="100%",this.form.style.inset="auto",this.form.style.bottom="0px",this.form.style[(e=this.settings)==null?void 0:e.form_position]=`${-document.body.clientWidth}px`,this.form.style.display="block"),setTimeout(this.showSlideboxForm.bind(this),100);return}this.form.style.height=this.formHeight,this.showFormWithSlideAnimation("width",this.formWidth)}showFormWithSlideAnimation(e,t){var i;this.form.style[e]=t,this.form.style[this.settings.form_position]=`-${t}`,new h().run(this.form,(i=this.settings)==null?void 0:i.form_position,-parseInt(t),0,this.showCallback.bind(this),"px",200)}showFullscreenForm(){if(!this.iframeLoaded){setTimeout(this.showFullscreenForm.bind(this),100);return}new h().run(this.form,"marginTop",-parseInt(this.form.style.height),0,this.showCallback.bind(this),"px",500)}hideFullScreenForm(){new h().run(this.form,"marginTop",0,-parseInt(this.form.style.height),this.hideCallback.bind(this),"px",500)}showCallback(){this.form.style.display="block",this.shown=!0,this.trackFormView()}hide(){var t,s,i;if(!this.shown)return;this.shown=!1;const e=(t=this.settings)==null?void 0:t.form_type;e==="popup"||e==="halfscreen"||this.usesNebula()&&e==="fullscreen"?new h().run(this.form,"opacity",1,0,this.hideCallback.bind(this)):e==="bar"?new h().run(this.form,(s=this.settings)==null?void 0:s.form_position,0,-parseInt(this.formHeight),this.hideCallback.bind(this),"px",200):e==="slidebox"?new h().run(this.form,(i=this.settings)==null?void 0:i.form_position,0,-parseInt(this.formWidth),this.hideCallback.bind(this),"px",200):e==="fullscreen"?this.hideFullScreenForm():this.hideCallback()}hideCallback(){this.backdrop&&(this.backdrop.style.display="none"),this.form.style.display="none"}isShowAllowed(){return this.isAllowedToShowOnPages()&&this.isVisibleOnDevice()&&this.isAllowedBasedOnFrequency()&&!this.getSubmittedCookieValue(c)}isVisibleOnDevice(){var s;let e=!0;const t=((s=this.settings)==null?void 0:s.hide_on)??[];for(let i=0;i<t.length;i++){const o=t[i];if(o==="mobile"&&d.isMobile()){e=!1;break}if(o==="desktop"&&d.isDesktop()){e=!1;break}if(o==="tablet"&&d.isTablet()){e=!1;break}}return e}isAllowedToShowOnPages(){var t,s;const e=((t=this.settings)==null?void 0:t.visibility)??!1;switch(e){case!1:case"always":return!0;case"blacklist":case"whitelist":{const i=((s=this.settings)==null?void 0:s.url_list)??[];return this.isAllowedByURLList(i,e)}}return!0}isAllowedByURLList(e=[],t){let s=!0;for(let i=0;i<e.length;i++){const o=e[i];if(this.isURLEquality(o)){if(t==="blacklist"){s=!1;break}s=!0;break}t==="whitelist"&&(s=!1)}return s}usesNebula(){return!!this.groot_v2_id}isURLEquality(e){var s;return((s=this.settings)==null?void 0:s.url_list_strict)??!1?window.location.href.replace(/\/+$/,"")===e:window.location.href.startsWith(e)}isAllowedBasedOnFrequency(){var t;return(((t=this.settings)==null?void 0:t.frequency_unit)??"always")==="always"?!0:!this.getShownCookieValue(c)&&!this.getSubmittedCookieValue(c)?(this.createShownCookie(),!0):!1}createShownCookie(){var i,o;const e=((i=this.settings)==null?void 0:i.frequency_unit)??"always";let s=parseInt((o=this.settings)==null?void 0:o.frequency)??1;e==="weeks"?s*=7:e==="months"&&(s*=30),c.set(this.getCookieNameWhenShown(),this.account,s)}isEventForThisBuilder(e){if(this.usesNebula()){const s=/popups-(.*)--/.exec(e.data);return s&&s[1]===this.groot_v2_id}const t=/webforms-(.*)--/.exec(e.data);return t&&t[1]===String(this.settings.groot_id)}isTeaserActiveOnStart(){return this.usesNebula()&&!!this.settings.teaser_active_on_start}}class k extends g{add(){this.form=this.injectForm(),this.shouldTrackView&&this.trackFormView()}injectForm(){const e=this.parentSlug||this.slug,t=document.querySelectorAll(`.ml-embedded[data-form="${e}"]`),s=this.getEmptyContainer(t);if(!s)return null;s.innerHTML=this.template;const i=s.getElementsByTagName("script"),o=Array.prototype.slice.call(i);for(const n of o)this.copyScriptToDocumentHead(n),n.remove&&n.remove();return s}getEmptyContainer(e){for(const[t,s]of e.entries())if(s.childElementCount===0)return this.shouldTrackView=t===0,s;return null}copyScriptToDocumentHead(e){if(this.documentContainsScript(e))return;const t=document.createElement("script");e.src&&t.setAttribute("src",e.src),e.type&&t.setAttribute("type",e.type),e.innerHTML&&(t.innerHTML=e.innerHTML),document.head.appendChild(t)}documentContainsScript(e){const t=document.head.getElementsByTagName("script");for(const s of t)if(this.scriptsAreSame(e,s))return!0;return!1}scriptsAreSame(e,t){return!!e.src&&!!t.src&&e.src===t.src}}class T{constructor(e){this.jsonpRequest=new p(e),this.popups={},this.popups_enabled=!0,this.grootEventListener=new _}renderEmbeddedForm(e){new k(e.data,this.jsonpRequest,this.account(),this.grootEventListener).add()}renderPopupsAndPromotions(e){const t=e.data;for(let s=0;s<t.length;s++){const i=new b(t[s],this.jsonpRequest,this.account(),this.grootEventListener),o=i.parentSlug||i.slug;this.popups[o]||(this.popups[o]=i),this.popups[o].setTriggers()}}addOnClickForm(e){const t=new b(e.data,this.jsonpRequest,this.account(),this.grootEventListener),s=t.parentSlug||t.slug;this.popups[s]||(this.popups[s]=t)}account(e=null){return e!==null&&(this.account_id=e),this.account_id}enablePopups(e=null){return e!==null&&(this.popups_enabled=e),this.popups_enabled}initializePage(e){new v(e,this.jsonpRequest).trackPageView(this.account())}initializeBlogPost(e){new C(e,this.jsonpRequest).trackPageView(this.account())}renderShoperSettings(e){e.success&&e.checkbox_active&&window.ml&&window.ml.fn&&window.ml.fn.insertNewsletterCheckbox&&window.ml.fn.insertNewsletterCheckbox(e)}initializeBlogCategory(e){new x(e,this.jsonpRequest).trackPageView(this.account())}initializeEmbeddedForm(e){new k({id:e},this.jsonpRequest,this.account()).trackFormView()}execute(e,t=[]){return e==="webpages"||e==="blog"?!1:this[e]===void 0?(console.error(`Invalid argument "${e}" passed to MailerLite script`),!1):this[e](...t)}show(e,t=!1){const s=this.popups[e];s&&s.show(t)}}const I=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,q=function(l,e){this.accountId=l,this.jsonpRequest=e,this.jsonpRequestData={},this.acceptsMarketing=!1,this.newsletterForm=!1,this.foundAcceptsMarketing=!1,this.init=()=>{window.addEventListener("submit",this.eventTrigger,!1)},this.eventTrigger=(function(t){if(this.jsonpRequestData.fields="",t.target.tagName==="FORM"){if(t.target.classList.contains("ml-block-form"))return;Array.from(t.target).forEach((s,i)=>{if(s.type==="email"&&s.getAttribute("class").toLowerCase().includes("newsletter")&&(this.newsletterForm=!0,this.jsonpRequestData.email=s.value,this.jsonpRequestData.fields+="&fields[accepts_marketing]=1"),s.type==="checkbox"){t.target[i-1].type==="email"?this.jsonpRequestData.email=t.target[i-1].value:t.target[i-1].type==="fieldset"&&t.target[i-2].type==="email"&&(this.jsonpRequestData.email=t.target[i-2].value);const o=new URLSearchParams(this.jsonpRequestData.fields);(!this.foundAcceptsMarketing||!o.get("fields[accepts_marketing]"))&&(this.jsonpRequestData.fields+=`&fields[accepts_marketing]=${s.checked?1:0}`,this.acceptsMarketing=!!s.checked,this.foundAcceptsMarketing=!0)}s.type==="text"&&s.name==="fname"&&s.value&&(this.jsonpRequestData.fields+=`&fields[name]=${encodeURIComponent(s.value)}`),s.type==="text"&&s.name==="lname"&&s.value&&(this.jsonpRequestData.fields+=`&fields[last_name]=${encodeURIComponent(s.value)}`)})}I.test(this.jsonpRequestData.email)&&this.postDataToMl()}).bind(this),this.postDataToMl=function(){if(this.jsonpRequestData.email=encodeURIComponent(this.jsonpRequestData.email),this.jsonpRequestData.fields==="")delete this.jsonpRequestData.fields;else if(!this.acceptsMarketing&&!this.newsletterForm)return;this.jsonpRequest.make(`/jsonp/${this.accountId}/squarespace`,null,this.jsonpRequestData)}};var R={VITE_PUSHER_APP_KEY:"X9rQ4CxH4yJTFN43oP9X",VITE_PUSHER_HOST:"ws.mailerlite.com",VITE_PUSHER_PORT:"443",VITE_APP_ENV:"production",VITE_SENTRY_LARAVEL_DSN:"https://7feaa0422f6b4f52b1ef9652cb106aef@o108590.ingest.sentry.io/1484551",VITE_HOST:"https://assets.mailerlite.com",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const A=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,w=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/,D=function(l,e){this.accountId=parseInt(l,10),this.jsonpRequest=e,this.jsonpRequestData={},this.acceptsMarketing=!1,this.init=()=>{window.wixDevelopersAnalytics.register(R.VITE_WIX_APP_ID,(t,s)=>{if(t==="InitiateCheckout"){const i=document.querySelector('[data-hook="CustomerDetailsStep.root"]');i&&new MutationObserver((n,r)=>{this.setupListeners(s)}).observe(i,{childList:!0}),this.setupListeners(s)}t==="StartPayment"&&this.setupListeners(s)})},this.setupListeners=function(t){const s=document.querySelector('div[data-hook="CustomerDetails.subscriptionCheckbox"] input[type="checkbox"]');s&&s.addEventListener("click",n=>{this.eventTrigger(n,t)},!1);const i=document.querySelector('div[data-hook="CheckboxesDataHooks.subscriptionCheckbox"] input[type="checkbox"]');i&&(i.addEventListener("click",n=>{this.eventTrigger(n,t)},!1),typeof(i==null?void 0:i.checked)=="boolean"&&i.checked&&this.eventTrigger({target:i},t));const o=document.querySelector('input[data-hook="CustomerDetails.temporaryEmailForSubscriptionABTest"]');o&&o.addEventListener("blur",n=>{this.eventTrigger(n,t)},!1)},this.eventTrigger=(function(t,s){if(!t||!t.target||!s||typeof s.metaSiteId!="string")return;const i=document.querySelector('div[data-hook="ContactAndAddressSummary.email"]')??document.querySelector('input[data-hook="CustomerDetails.temporaryEmailForSubscriptionABTest"]'),o=s.metaSiteId?s.metaSiteId.trim().replace(/[^a-zA-Z0-9-]/g,""):null,n=document.querySelector('div[data-hook="CheckboxesDataHooks.subscriptionCheckbox"] input[type="checkbox"]')??document.querySelector('div[data-hook="CustomerDetails.subscriptionCheckbox"] input[type="checkbox"]'),r=typeof(n==null?void 0:n.checked)=="boolean"?n.checked:null;i&&o&&r!==null&&(this.jsonpRequestData.email=i.tagName==="INPUT"?i.value.trim().toLowerCase():i.textContent.trim().toLowerCase(),this.jsonpRequestData.site_id=w.test(o)?o:null,this.jsonpRequestData.accepts_marketing=r,this.postDataToMl())}).bind(this),this.postDataToMl=function(){const{email:t,site_id:s,accepts_marketing:i}=this.jsonpRequestData;if(!(!s||typeof i!="boolean"||isNaN(this.accountId)||this.accountId<=0||this.accountId>Number.MAX_SAFE_INTEGER)&&A.test(t)&&w.test(s)&&s.length===36){const o={email:encodeURIComponent(t),site_id:s,accepts_marketing:i};this.jsonpRequest.make(`/jsonp/${encodeURIComponent(this.accountId)}/wix`,null,o)}}};class M{getBasketData(){var e,t,s;try{const i=["BasketLocalStore.basket","frontstoreBasket"];for(const o of i){const n=localStorage.getItem(o);if(n)try{const r=JSON.parse(n);if(!r||typeof r!="object")continue;const a={...r};return o==="BasketLocalStore.basket"?((e=r.items)!=null&&e.list&&(a.products=r.items.list),((t=r.sum)==null?void 0:t.grossValue)!==void 0&&(a.sum_float=r.sum.grossValue),a.id=localStorage.getItem("basketIndex")):r.basket&&(r.basket.sum_float!==void 0&&(a.sum_float=r.basket.sum_float),(s=r.basket.products)!=null&&s.length&&(a.products=r.basket.products)),a}catch{continue}}return null}catch{return null}}hasValidDataToSend(e){var i,o,n;const t=document.querySelector('input[name="mail"][id="input_mail"]');if((i=t==null?void 0:t.value)!=null&&i.trim()&&this.isValidEmail(t.value.trim()))return!0;if(!e)return!1;const s=((o=e.billingAddress)==null?void 0:o.email)||((n=e.user_info)==null?void 0:n.mail);return(s==null?void 0:s.trim())&&this.isValidEmail(s.trim())}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}getEmailFromInput(){var s;const e=document.querySelector('input[name="mail"][id="input_mail"]'),t=(s=e==null?void 0:e.value)==null?void 0:s.trim();return t&&this.isValidEmail(t)?t:null}getEmailFromBasket(e){var s,i;if(!e)return null;const t=((s=e.billingAddress)==null?void 0:s.email)||((i=e.user_info)==null?void 0:i.mail);return(t==null?void 0:t.trim())||null}createBillingAddress(e,t=null){var i,o;const s=t||this.getEmailFromInput();if(s)return{email:s,firstName:null,lastName:null,phone:null,city:null,country:null,company:null,postalCode:null,province:null};if(!e)return{};if((i=e.billingAddress)!=null&&i.email)return e.billingAddress;if((o=e.user_info)!=null&&o.mail){const n=e.billing_address;return{email:e.user_info.mail,firstName:(n==null?void 0:n.firstname)||null,lastName:(n==null?void 0:n.lastname)||null,phone:(n==null?void 0:n.phone)||null,city:(n==null?void 0:n.city)||null,country:(n==null?void 0:n.country)||null,company:(n==null?void 0:n.company_name)||null,postalCode:(n==null?void 0:n.zip)||null,province:(n==null?void 0:n.state)||null}}return{}}}class L{constructor(e,t){this.accountId=e,this.apiManager=t}shouldInsertCheckbox(){return this.isShoperShop()?["basket","checkout","order","koszyk","zamowienie"].some(s=>window.location.pathname.toLowerCase().includes(s))&&(document.querySelector(".client-add-info")||document.querySelector('[data-module-name="basket_additional_fields"]')):!1}isShoperShop(){return document.querySelector('script[src*="shoper"]')?!0:[".client-add-info",'[data-module-name="basket_additional_fields"]','input[name="mail"][id="input_mail"]','script[src*="dcsaascdn.net"]','script[src*="frontstore"]'].some(t=>document.querySelector(t)!==null)}checkAndInsertCheckbox(){this.removeExistingCheckboxes(),this.shouldInsertCheckbox()&&this.insertNewsletterCheckbox()}insertNewsletterCheckbox(e=null){!e&&c.get("shoper_settings")&&(e=JSON.parse(c.get("shoper_settings"))),e!=null&&e.checkbox_active?this.createAndInsertCheckbox(e):e||this.fetchShoperSettings()}fetchShoperSettings(){var e;if(this.accountId||(this.accountId=((e=window.mailerliteData)==null?void 0:e.account)??null),this.accountId&&this.apiManager)try{this.apiManager.fetchShoperSettings()}catch{}}createAndInsertCheckbox(e){this.removeExistingCheckboxes();const t=this.findInsertionPoint();if(!t)return;const s=t.element.tagName==="TR"||t.element.closest("table"),i=this.createCheckboxElement(e,s?"table":"div");t.type==="after"?t.element.parentNode.insertBefore(i,t.element.nextSibling):t.element.appendChild(i),this.setupCheckboxEventListeners(i,e)}removeExistingCheckboxes(){document.querySelectorAll('.ml-newsletter-checkbox, input[id="ml_newsletter_subscription"]').forEach(e=>e.remove()),document.querySelectorAll("td:empty").forEach(e=>{var t;((t=e.parentElement)==null?void 0:t.children.length)===1&&e.parentElement.remove()})}createCheckboxElement(e,t="table"){return t==="table"?this.createTableCheckbox(e):this.createDivCheckbox(e)}createTableCheckbox(e){const t=document.createElement("tr");t.className="ml-newsletter-checkbox",t.style.cssText="border: none; background: transparent;";const s=document.createElement("td");s.className="label",s.style.cssText="vertical-align: top; padding: 8px 12px 8px 0; border: none;";const i=document.createElement("td");i.className="input",i.setAttribute("colspan","2"),i.style.cssText="vertical-align: top; padding: 8px 0; border: none;";const o=document.createElement("span");o.className="checkbox-wrap",o.style.cssText="display: inline-block; margin-right: 8px;";const n=document.createElement("input");Object.assign(n,{type:"checkbox",name:"ml_newsletter_subscription",id:"ml_newsletter_subscription",className:"checkbox",value:"1",checked:e.checkbox_preselect}),n.style.cssText="margin: 0; cursor: pointer;";const r=document.createElement("label");r.htmlFor="ml_newsletter_subscription",r.style.cssText="margin: 0; cursor: pointer; display: inline-block; width: 16px; height: 16px;";const a=document.createElement("label");return a.htmlFor="ml_newsletter_subscription",a.style.cssText="cursor: pointer; margin: 0; font-weight: normal;",a.textContent=e.checkbox_content||"Subscribe to our newsletter",o.appendChild(n),o.appendChild(r),i.appendChild(o),i.appendChild(a),t.appendChild(s),t.appendChild(i),t}createDivCheckbox(e){const t=document.createElement("div");t.className="ml-newsletter-checkbox";const s=document.querySelector('[data-module-name="basket_additional_fields"] h-control');if(s){const i=window.getComputedStyle(s);t.style.cssText=`
                margin: ${i.margin}; padding: ${i.padding}; border: ${i.border};
                background: ${i.background}; font-family: ${i.fontFamily}; font-size: ${i.fontSize};
                line-height: ${i.lineHeight}; color: ${i.color}; display: block; width: 100%;
            `}return t.innerHTML=`
            <div class="control" style="margin: 0 0 16px 0; padding: 0;">
                <div class="control control__content" style="display: block;">
                    <div class="control__element" style="display: block;">
                        <div class="checkbox" style="display: flex;">
                            <div class="checkbox__control" style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" class="checkbox__input" id="ml_newsletter_subscription"
                                       name="ml_newsletter_subscription" value="1"
                                       style="margin: 0; cursor: pointer; flex-shrink: 0;"
                                       ${e.checkbox_preselect?"checked":""}>
                                <label class="checkbox__label" for="ml_newsletter_subscription"
                                       style="margin: 0; cursor: pointer; display: block; position: relative;">
                                    <span style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: transparent;"></span>
                                </label>
                            </div>
                            <div class="checkbox__content" style="display: block;">
                                <label class="label" for="ml_newsletter_subscription" style="cursor: pointer; font-size: 14px; margin: 0; user-select: none; line-height: 1.4; display: block;">
                                    <span style="display: inline;">${e.checkbox_content||"Subscribe to our newsletter"}</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `,t}findInsertionPoint(){const e=document.querySelector("tr.newsletter");if(e)return{element:e,type:"after"};const t=document.querySelector(".client-add-info");if(t){const i=t.querySelector("table");if(i)return{element:i,type:"inside"}}const s=document.querySelector('[data-module-name="basket_additional_fields"]');if(s){const i=s.querySelector("form.form");if(i){const o=i.querySelector("h-control:last-of-type");return o?{element:o,type:"after"}:{element:i,type:"inside"}}}return null}setupCheckboxEventListeners(e,t){const s=e.querySelector('input[type="checkbox"]');s&&(this.restoreCheckboxState(s),s.addEventListener("change",i=>{var n,r;const o=i.target.checked;i.target.value=o?"1":"0",c.set("ml_newsletter_subscription",o?"true":"",o?1:-1),(r=(n=window.ml)==null?void 0:n.fn)!=null&&r.onCheckboxChange&&window.ml.fn.onCheckboxChange(o)}))}restoreCheckboxState(e){var t,s;try{c.get("ml_newsletter_subscription")==="true"&&(e.checked=!0,e.value="1",(s=(t=window.ml)==null?void 0:t.fn)!=null&&s.onCheckboxRestored&&setTimeout(()=>window.ml.fn.onCheckboxRestored(!0),500))}catch{}}}class F{constructor(){this.domObserver=null,this.urlChangeTimer=null,this.domChangeTimer=null,this.emailDebounceTimer=null,this.originalPushState=null,this.originalReplaceState=null,this.popstateHandler=null,this.hashChangeHandler=null}setupLocalStorageListener(){this.setupStorageEventListener(),this.setupDOMObserver()}setupStorageEventListener(){window.addEventListener("storage",e=>{["BasketLocalStore.basket","frontstoreBasket"].includes(e.key)&&this.handleBasketDataChange()}),this.overrideLocalStorageMethods()}overrideLocalStorageMethods(){const e=localStorage.setItem,t=localStorage.removeItem,s=localStorage.clear,i=["BasketLocalStore.basket","frontstoreBasket"];localStorage.setItem=(o,n)=>{const r=e.call(localStorage,o,n);return i.includes(o)&&this.handleBasketDataChange(),r},localStorage.removeItem=o=>{const n=t.call(localStorage,o);return i.includes(o)&&this.handleBasketDataChange(),n},localStorage.clear=()=>{const o=s.call(localStorage);return this.handleBasketDataChange(),o}}setupDOMObserver(){this.domObserver=new MutationObserver(e=>{e.some(s=>s.type==="childList"&&Array.from(s.addedNodes).some(i=>i.nodeType===Node.ELEMENT_NODE&&this.isRelevantFormElement(i)))&&(clearTimeout(this.domChangeTimer),this.domChangeTimer=setTimeout(()=>this.handleBasketDataChange(),1e3))}),this.domObserver.observe(document.body,{childList:!0,subtree:!0,attributes:!1,characterData:!1})}isRelevantFormElement(e){if(["INPUT","SELECT","TEXTAREA"].includes(e.tagName)){const t=(e.getAttribute("name")||"").toLowerCase(),s=(e.getAttribute("id")||"").toLowerCase();return["mail","email","billing","shipping","address"].some(o=>t.includes(o)||s.includes(o))}return e.querySelector?['input[name*="mail"]','input[name*="email"]','input[name*="billing"]','input[name*="shipping"]','input[name*="address"]','select[name*="billing"]','select[name*="shipping"]'].some(s=>e.querySelector(s)):!1}handleBasketDataChange(){var e,t;(t=(e=window.ml)==null?void 0:e.fn)!=null&&t.onBasketDataChange&&window.ml.fn.onBasketDataChange()}setupEmailInputListener(){const e=document.querySelector('input[name="mail"][id="input_mail"],input[name="email"]');if(!e)return;const t=()=>{clearTimeout(this.emailDebounceTimer),this.emailDebounceTimer=setTimeout(()=>this.handleEmailInputChange(),1e3)},s=()=>{clearTimeout(this.emailDebounceTimer),this.handleEmailInputChange()};e.addEventListener("input",t),e.addEventListener("blur",s)}handleEmailInputChange(){var e,t;(t=(e=window.ml)==null?void 0:e.fn)!=null&&t.onEmailInputChange&&window.ml.fn.onEmailInputChange()}setupUrlChangeDetection(){this.originalPushState=history.pushState,this.originalReplaceState=history.replaceState,this.popstateHandler=()=>this.handleUrlChange(),this.hashChangeHandler=()=>this.handleUrlChange(),window.addEventListener("popstate",this.popstateHandler),window.addEventListener("hashchange",this.hashChangeHandler),history.pushState=(...e)=>{this.originalPushState.apply(history,e),this.handleUrlChange()},history.replaceState=(...e)=>{this.originalReplaceState.apply(history,e),this.handleUrlChange()}}handleUrlChange(){clearTimeout(this.urlChangeTimer),this.urlChangeTimer=setTimeout(()=>this.onUrlChanged(),1e3)}onUrlChanged(){var e,t;(t=(e=window.ml)==null?void 0:e.fn)!=null&&t.onUrlChanged&&window.ml.fn.onUrlChanged()}cleanup(){[this.domChangeTimer,this.emailDebounceTimer,this.urlChangeTimer].forEach(s=>{s&&clearTimeout(s)}),this.domObserver&&(this.domObserver.disconnect(),this.domObserver=null),[{handler:this.popstateHandler,event:"popstate"},{handler:this.hashChangeHandler,event:"hashchange"}].forEach(({handler:s,event:i})=>{s&&window.removeEventListener(i,s)}),this.originalPushState&&(history.pushState=this.originalPushState,this.originalPushState=null),this.originalReplaceState&&(history.replaceState=this.originalReplaceState,this.originalReplaceState=null),Object.assign(this,{domObserver:null,urlChangeTimer:null,domChangeTimer:null,emailDebounceTimer:null,originalPushState:null,originalReplaceState:null,popstateHandler:null,hashChangeHandler:null})}}class j{constructor(e,t){this.accountId=e,this.jsonpRequest=t,this.debounceTimer=null}fetchShoperSettings(){var e;if(this.accountId||(this.accountId=((e=window.mailerliteData)==null?void 0:e.account)??null),!!this.accountId)try{this.jsonpRequest.make(`/jsonp/${this.accountId}/shoper-settings`,"renderShoperSettings",{shop_url:window.location.href})}catch{}}renderShoperSettings(e){var t,s;c.set("shoper_settings",JSON.stringify(e),5/60/24),e!=null&&e.success&&((s=(t=window.ml)==null?void 0:t.fn)!=null&&s.onShoperSettingsReceived)&&window.ml.fn.onShoperSettingsReceived(e)}sendCheckboxData(e){var s,i;let t=null;if(e.products[0]&&e.products[0].productId&&e.products[0].sum&&e.products[0].quantity&&(t=e.products.map(({productId:o,sum:n,quantity:r})=>({product_id:o,sum_float:n.grossValue,variant:"",quantity:r}))),!!((s=e.billing_address)!=null&&s.email))try{c.get("ml_resource")||c.set("ml_resource",Date.now().toString(),1);const o={account_id:e.account_id,shop_url:e.shop_url,basket_url:window.location.href,checkbox_value:e.checkbox_value,ml_resource:c.get("ml_resource"),"billing_address[email]":encodeURIComponent(e.billing_address.email)};e.basket_id&&(o.basket_id=e.basket_id),e.sum_float!==void 0&&(o.sum_float=e.sum_float),(i=e.products)!=null&&i.length&&(o.products=JSON.stringify(e.products)),t!=null&&t.length&&(o.products=JSON.stringify(t));const n=e.billing_address;n.firstName&&(o["billing_address[firstName]"]=n.firstName),n.lastName&&(o["billing_address[lastName]"]=n.lastName),n.phone&&(o["billing_address[phone]"]=n.phone),n.city&&(o["billing_address[city]"]=n.city),n.country&&(o["billing_address[country]"]=n.country),this.jsonpRequest.make(`/jsonp/${this.accountId}/shoper-abandoned-cart-data`,"handleAbandonedCartDataResponse",o)}catch(o){console.error("Error in sendCheckboxData:",o)}}handleAbandonedCartDataResponse(){}sendOrderResourceUpdate(e,t){const s=c.get("ml_resource");if(s)try{const i={ml_resource:s,order_id:e,shop_url:t,checkbox_value:c.get("ml_newsletter_subscription")==="true"};this.jsonpRequest.make(`/jsonp/${this.accountId}/shoper-complete-order`,"handleCompleteOrderResponse",i)}catch(i){console.error("Error sending order resource update:",i)}}handleCompleteOrderResponse(e){e!=null&&e.success&&(c.set("ml_newsletter_subscription","",-1),c.set("ml_resource","",-1))}debounceBillingInfoUpdate(e){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{var t,s;(s=(t=window.ml)==null?void 0:t.fn)!=null&&s.onSendUpdatedBillingInfo&&window.ml.fn.onSendUpdatedBillingInfo(e)},3e3)}checkConfirmedOrder(){const e=window.location.pathname.match(/\/basket\/done\/(\d+)/i);e&&this.sendOrderResourceUpdate(e[1],window.location.href)}cleanup(){clearTimeout(this.debounceTimer),this.debounceTimer=null}}const N=function(l,e){this.accountId=parseInt(l,10),this.jsonpRequest=e,this.basketManager=new M,this.apiManager=new j(this.accountId,e),this.checkboxManager=new L(this.accountId,this.apiManager),this.eventManager=new F,this.init=()=>{this.setupGlobalCallbacks(),this.exposeToGlobal(),this.checkboxManager.checkAndInsertCheckbox(),this.eventManager.setupLocalStorageListener();const t=new MutationObserver(()=>{document.querySelector('input[name="mail"][id="input_mail"], input[name="email"]')&&(this.eventManager.setupEmailInputListener(),t.disconnect())});t.observe(document.body,{childList:!0,subtree:!0}),this.eventManager.setupEmailInputListener(),this.eventManager.setupUrlChangeDetection(),this.apiManager.checkConfirmedOrder()},this.setupGlobalCallbacks=()=>{window.ml=window.ml||{},window.ml.fn=window.ml.fn||{};const t={onBasketDataChange:()=>{const s=this.basketManager.getBasketData();this.basketManager.hasValidDataToSend(s)&&this.apiManager.debounceBillingInfoUpdate(s)},onEmailInputChange:()=>this.checkAndSendData(),onUrlChanged:()=>{this.checkboxManager.checkAndInsertCheckbox(),this.eventManager.setupEmailInputListener(),this.apiManager.checkConfirmedOrder()},onCheckboxChange:()=>this.checkAndSendData(),onCheckboxRestored:s=>this.captureBasketInfo(s),onShoperSettingsReceived:s=>this.checkboxManager.createAndInsertCheckbox(s),onSendUpdatedBillingInfo:()=>this.sendUpdatedBillingInfo()};Object.assign(window.ml.fn,t)},this.checkAndSendData=()=>{const t=document.querySelector('input[id="ml_newsletter_subscription"]'),s=(t==null?void 0:t.checked)||!1,i=this.basketManager.getEmailFromInput()||this.basketManager.getEmailFromBasket(this.basketManager.getBasketData());i&&this.basketManager.isValidEmail(i)&&this.sendDataWithEmailAndCheckbox(i,s)},this.sendDataWithEmailAndCheckbox=(t,s=!0)=>{var i;try{const o=this.basketManager.getBasketData();if(!o)return;const n={checkbox_value:s,account_id:this.accountId,shop_url:window.location.href,basket_id:o.id||null,billing_address:{email:t,firstName:null,lastName:null,phone:null,city:null,country:null,company:null,postalCode:null,province:null}};o.sum_float!==void 0&&(n.sum_float=o.sum_float),(i=o.products)!=null&&i.length&&(n.products=o.products),this.apiManager.sendCheckboxData(n)}catch(o){console.error("Error sending data with email and checkbox:",o)}},this.captureBasketInfo=t=>{var s,i,o;try{const n=this.basketManager.getBasketData();if(!n){setTimeout(()=>this.captureBasketInfo(t),2e3);return}if(!this.basketManager.hasValidDataToSend(n))return;const r={checkbox_value:t,account_id:this.accountId,shop_url:window.location.href,basket_id:n.id||null};if(n.sum_float!==void 0&&(r.sum_float=n.sum_float),(s=n.products)!=null&&s.length&&(r.products=n.products),(i=n.billingAddress)!=null&&i.email)r.billing_address=n.billingAddress;else if((o=n.user_info)!=null&&o.mail){const a=n.billing_address;r.billing_address={email:n.user_info.mail,firstName:(a==null?void 0:a.firstname)||null,phone:(a==null?void 0:a.phone)||null,city:(a==null?void 0:a.city)||null,country:(a==null?void 0:a.country)||null,company:(a==null?void 0:a.company_name)||null,postalCode:(a==null?void 0:a.zip)||null,province:(a==null?void 0:a.state)||null}}this.apiManager.sendCheckboxData(r)}catch(n){console.error("Error capturing basket info:",n)}},this.sendUpdatedBillingInfo=()=>{var n;const t=this.basketManager.getBasketData();if(!this.basketManager.hasValidDataToSend(t))return;const s=document.querySelector('input[id="ml_newsletter_subscription"]');if(!(s!=null&&s.checked))return;const i=this.basketManager.createBillingAddress(t),o={account_id:this.accountId,shop_url:window.location.href,checkbox_value:!0,basket_id:t.id||t.basketId||null,billing_address:i};t.sum_float!==void 0&&(o.sum_float=t.sum_float),(n=t.products)!=null&&n.length&&(o.products=t.products),this.apiManager.sendCheckboxData(o)},this.exposeToGlobal=()=>{var s;if(!((s=window.ml)!=null&&s.fn))return;const t={insertNewsletterCheckbox:this.checkboxManager.insertNewsletterCheckbox.bind(this.checkboxManager),fetchShoperSettings:this.apiManager.fetchShoperSettings.bind(this.apiManager),handleAbandonedCartDataResponse:this.apiManager.handleAbandonedCartDataResponse.bind(this.apiManager),handleCompleteOrderResponse:this.apiManager.handleCompleteOrderResponse.bind(this.apiManager),renderShoperSettings:this.apiManager.renderShoperSettings.bind(this.apiManager),checkAndInsertCheckbox:this.checkboxManager.checkAndInsertCheckbox.bind(this.checkboxManager),forceRefreshCheckbox:()=>this.checkboxManager.checkAndInsertCheckbox(),cleanup:()=>{this.eventManager.cleanup(),this.apiManager.cleanup()}};Object.assign(window.ml.fn,t)}};class ${constructor(e,t){this.config=e,this.callbacks=t,this.jsonpRequest=new p(e)}init(){window[this.config.facade]&&window[this.config.facade].q!==void 0&&this.processQueue(window[this.config.facade].q);const e=this;this.facade=function(t,...s){return e.callbacks.execute(t,s)},window[this.config.facade]=this.facade,this.facade.fn=this.callbacks,this.loadStyleSheet(this.config.stylesheet),this.parseAccountIdFromSrcAttribute(),this.fetchEmbeddedForms(),this.fetchPopupsAndPromotions(),this.fetchOnClickForms(),this.saveEcommerceVisit(),document.querySelector('script[src*="squarespace"]')&&new q(this.callbacks.account(),this.jsonpRequest).init(),document.querySelector('script[src*="wix"]')&&new D(this.callbacks.account(),this.jsonpRequest).init(),this.isShoperShop()&&new N(this.callbacks.account(),this.jsonpRequest).init()}loadStyleSheet(e){const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("media","all"),t.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(t)}processQueue(e){for(;e.length;){const t=Array.prototype.slice.call(e.shift()),s=t.shift();this.callbacks.execute(s,t)}}domReady(e){document.readyState!=="loading"?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&e()})}fetchOnClickForms(){const e=this.callbacks.account();if(!e)return;const t=document.getElementsByClassName("ml-onclick-form");for(let s=0;s<t.length;s++){const i=t[s].getAttribute("onclick");if(i){const o=i.split(", ")[1].slice(1,-1);o&&this.jsonpRequest.make(`/jsonp/${e}/forms/${o}`,"addOnClickForm")}}}fetchEmbeddedForms(){const e=document.getElementsByClassName("ml-embedded");for(let t=0;t<e.length;t++){const s=e[t].getAttribute("data-form");s&&this.fetchEmbeddedForm(s)}}fetchEmbeddedForm(e){const t=this.callbacks.account();t&&this.jsonpRequest.make(`/jsonp/${t}/forms/${e}`,"renderEmbeddedForm")}fetchPopupsAndPromotions(){const e=this.callbacks.account();if(e&&this.callbacks.enablePopups()){const t=window&&window.Shopify&&window.Shopify.shop?{shop:1}:{};this.jsonpRequest.make(`/jsonp/${e}/forms`,"renderPopupsAndPromotions",t)}}parseAccountIdFromSrcAttribute(){const e=document.getElementsByTagName("script");for(let t=0;t<e.length;t++){const s=e[t];if(s.src===void 0)continue;const i=s.src.split("#account=");if(i[1]!==void 0)return this.callbacks.account(i[1])}}saveEcommerceVisit(){const e=this.callbacks.account(),t=window.location.pathname.split("/")[1];let s=window.location.hostname+(t?`/${t}`:"");window&&window.Shopify&&window.Shopify.shop&&(s=window.Shopify.shop);const i=new URLSearchParams(window.location.search),o=i.get("ml_recipient"),n=i.get("ml_link"),r=/^\d+$/;e&&o&&n&&r.test(o)&&r.test(n)&&r.test(e)&&this.jsonpRequest.noCache().make(`/jsonp/${e}/ecommerce/${o}/${n}`,null,{shop:s})}isShoperShop(){return document.querySelector('script[src*="shoper"]')?!0:[".client-add-info",'[data-module-name="basket_additional_fields"]','input[name="mail"][id="input_mail"]','script[src*="dcsaascdn.net"]','script[src*="frontstore"]'].some(t=>document.querySelector(t)!==null)}}const B=new T(u),y=new $(u,B);y.domReady(()=>{window[`__${u.facade}__initialized`]||(y.init(),window[`__${u.facade}__initialized`]=!0)})})();
